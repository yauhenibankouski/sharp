<% available_trainers.each do |trainer| %>
  <div class="card mb-3" >
    <img class="card-img-top"
      src="https://source.unsplash.com/random"
      alt="Image of user goes here"
      height='100px'
    >
    <div class="card-body">
      <div class="d-flex justify-content-between">
        <button type="button" class="button-dark-grey-expert" data-toggle="modal" data-target="#exampleModal">
          <h3 class="card-subtitle"> <%= "About #{trainer.first_name.capitalize} #{trainer.last_name.capitalize}" %> </h3>
        </button>
        <div>
          <i class="fas fa-star text-warning"></i>
          <i class="fas fa-star text-warning"></i>
          <i class="fas fa-star text-warning"></i>
          <i class="fas fa-star text-warning"></i>
          <i class="far fa-star text-warning"></i>
        </div>
      </div>
      <p class="card-text fs-md mb-3 text-black-50"> <%= trainer.about %> </p>
      <div id="trainer-<%= trainer.id %>" >
        <% if trainer.bookings.any? { |b| b.client_id == user.id } %>
          <% case trainer.bookings.select { |b| b.client_id == user.id }.first.status %>
            <% when 'Pending' %>
              <div class='m-0 p-1 text-black-50'>
                <i class="fas fa-spinner"></i>
                <span>Request sent to <%= trainer.first_name.capitalize %></span>
                <%= simple_form_for trainer.bookings.select { |b| b.client_id == user.id}, id: 'cancel', remote: true, method: :delete do |f| %>
                  <%= f.submit "Cancel", class: 'btn btn-danger' %>
                <% end %>
              </div>
            <% when 'Accepted' %>
              <%= link_to "See assigned workouts",
                booking_shared_training_plans_path(trainer.bookings.select { |b| b.client_id == user.id }.first), class: 'button-orange' %>
            <% when 'Rejected' %>
              <div class='m-0 p-1'>
                <i class="fas fa-exclamation-triangle text-warning"></i>
                <span class="text-dark">It seems that <%= trainer.first_name.capitalize %> is full right now</span>
                <p class="text-black-50">You've been added to <%= trainer.first_name.capitalize %>'s' waitlist and we'll notify you when the request is approved</p>
                <%= link_to "Cancel", trainer.bookings.select { |b| b.client_id == user.id }.first, id: 'cancel', remote: true, method: :delete %>
              </div>
          <% end %>
          <% else %>
            <%= simple_form_for @booking, remote: true do |f| %>
              <%= f.hidden_field :status, value: "Pending" %>
              <%= f.hidden_field :user_id, value: trainer.id %>
              <%= f.hidden_field :client_id, value: user.id %>
              <%= f.submit "Book #{trainer.first_name.capitalize}!", class: 'btn btn-primary'%>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
      
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="exampleModalLabel"><%= "#{trainer.first_name.capitalize} #{trainer.last_name.capitalize}" %></h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4><%= trainer.about %></h4>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
<% end %>
